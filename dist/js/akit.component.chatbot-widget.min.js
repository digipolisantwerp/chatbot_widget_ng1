!function(t){"use strict";window.angular.module("akit.component.chatbotWidget",[])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget",[])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").controller("akit.component.chatbotWidget.chatbotMessageController",["$scope","$timeout",function(e){this.data=e.data||{hide:!0},this.sendReply=function(t){e.$emit("chatbotMessageReplyClicked",{message:t}),e.data.hide=!0}}])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").controller("akit.component.chatbotWidget.chatbotWidgetController",["$scope","$timeout","akit.component.chatbotWidget.chatbotService",function(a,s,n){this.pinned="false"!==a.pinned&&!!a.pinned,this.pinnedtext=a.pinnedtext||"Een vraag stellen",this.placeholder=a.placeholder||"",this.delay=a.delay||400,this.title=a.title||"",this.avatar=a.avatar||"https://cdn.antwerpen.be/core_branding_favicons/chatbot/a-chat.svg",this.session=a.session,this.initialmessage=a.initialmessage||"STARTCOMMANDO",a.focusTextInput=!1;var i=this;i.data=[],i.message={session_id:this.session,message:"",type:"text",send:!0},i.isLoading=!1,i.isOpen=!1,i.loadingIndex=!1,i.sendMessage=function(t,e){t&&(i.message.message=t),(i.message.message||e)&&(i.isLoading=!0,e||i.addToChat(i.message),n.sendMessage(a.url,i.message).then(function(t){if(!t.data)throw new Error("no data returned from service");t.data.forEach(function(t,e,a){i.loadingIndex=e,i.isLoading=!0,s(function(){0===e&&(t.avatar=i.avatar),i.addToChat(t),e===a.length-1&&(i.loadingIndex=null,i.isLoading=!1)},e*i.delay)})}).catch(function(t){i.pushError(t),i.isLoading=!1}),this.message.message="",a.focusTextInput=!0)},i.toggleChatbot=function(){this.isOpen=!this.isOpen,this.isOpen&&s(function(){a.focusTextInput=!0})},i.sendReply=function(t,e){i.sendMessage(e.message)},i.onInputKey=function(t){13===t.which&&i.sendMessage()},a.$on("chatbotMessageReplyClicked",i.sendReply),i.addToChat=function(t){if("text"===t.type&&""===t.message);else{var e=[].concat(i.data,[Object.assign({},t)]);this.data=e}},i.pushError=function(t){var e={message:"Error "+t.status+" - "+t.statusText+": "+t.error.title,type:"error"};this.addToChat(e)},i.sendMessage(this.initialmessage,!0)}])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").directive("auiChatbotMessage",["$timeout","$window",function(t,e){return{restrict:"E",replace:!0,templateUrl:"/assets/chatbot-widget/views/directives/chatbot-message.htm",controller:"akit.component.chatbotWidget.chatbotMessageController",controllerAs:"msg",scope:{data:"="}}}])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").directive("auiChatbotWidget",[function(){return{restrict:"AE",replace:!0,templateUrl:"/assets/chatbot-widget/views/directives/chatbot-widget.htm",controller:"akit.component.chatbotWidget.chatbotWidgetController",controllerAs:"chatbot",scope:{url:"@",session:"@",title:"@",pinned:"@?",pinnedtext:"@?",placeholder:"@?",delay:"@?",height:"=?",initialmessage:"@?",avatar:"@?"},link:function(t,e,a,s){}}}])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").directive("focusFrom",["$timeout","$parse",function(n,t){return{restrict:"A",link:function(e,a,s){e.$watch(s.focusFrom,function(t){t&&(n(function(){a[0].focus()}),e.$parent[s.focusFrom]=!1)})}}}])}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").directive("scrollToBottom",function(s,t){return{scope:{scrollToBottom:"="},restrict:"A",link:function(t,e,a){t.$watchCollection("scrollToBottom",function(t){t&&s(function(){e[0].scrollTop=e[0].scrollHeight},0)})}}})}(),function(t){"use strict";window.angular.module("akit.component.chatbotWidget").service("akit.component.chatbotWidget.chatbotService",["$http","$interval","$q",function(a){var t={};return t.sendMessage=function(t,e){return a.post(t,Object.assign({},e)).then(function(t){var e=t.data;return e.quickReplies&&e.data.push({type:"radio",message:"",elements:e.quickReplies.map(function(t){return{text:t.text,replyText:t.action}})}),e})},t}])}(),angular.module("akit.component.chatbotWidget").run(["$templateCache",function(t){t.put("/assets/chatbot-widget/views/directives/chatbot-message.htm",'<div><div class="m-message" ng-class="{\'m-message--right\': msg.data.send, \'m-message--center\': msg.data.type === \'radio\' || msg.data.type === \'error\'}" ng-if="!msg.data.hide"><div ng-if="!msg.data.send && msg.data.avatar" class="a-avatar a-avatar--small"><img ng-src="{{ msg.data.avatar }}" alt="Avatar"></div><div ng-switch="msg.data.type" class="m-message__content"><span ng-switch-when="text" class="m-message__text" tabindex="0">{{ msg.data.message }}</span><span ng-switch-when="url" class="m-message__url"><a ng-href="{{ msg.data.url }}" target="_blank" rel="external">{{ msg.data.message }}</a></span><span ng-switch-when="image" class="m-message__image" tabindex="0"><img ng-src="{{ msg.data.image }}"></span><span ng-switch-when="radio" class="m-message__radio"><ng-container ng-repeat="element in msg.data.elements"><button ng-click="msg.sendReply(element.replyText)" class="button a-button a-button--small">{{ element.text }}</button></ng-container></span><span ng-switch-when="error" class="m-message__error u-text-danger" tabindex="0">{{ msg.data.message }}</span></div></div></div>'),t.put("/assets/chatbot-widget/views/directives/chatbot-widget.htm",'<div class="o-chatbot" ng-class="{\'o-chatbot--pinned\': chatbot.pinned}" ng-style="{\'height\':!chatbot.pinned ? height + \'px\' : \'\' }"><div class="o-chatbot__content" ng-if="!chatbot.pinned || (chatbot.pinned && chatbot.isOpen)"><div class="o-chatbot__header bg-primary u-text-xlight" ng-class="{\'o-chatbot__header--no-title\': !chatbot.title}"><h1 class="h6 has-base-font u-text-bold u-margin-xs" ng-if="chatbot.title">{{ chatbot.title }}</h1><button class="button icon" ng-if="chatbot.pinned" ng-click="chatbot.toggleChatbot()"><i class="fa fa-close"></i></button></div><div class="o-chatbot__main" scroll-to-bottom="chatbot.data"><div ng-if="chatbot.data && (chatbot.data.length > 0)" class="u-margin-xs" aria-live="assertive"><ng-container ng-repeat="message in chatbot.data"><aui-chatbot-message data="message"></aui-chatbot-message></ng-container><div ng-if="chatbot.isLoading" class="o-chatbot__loader"><div class="a-avatar a-avatar--small" ng-if="!chatbot.loadingIndex"><img ng-src="{{ chatbot.avatar }}" alt="Avatar"></div><span>...</span></div></div></div><div class="o-chatbot__footer"><div class="o-chatbot__input"><input type="text" class="field" name="chat-input" autocomplete="off" placeholder="{{ chatbot.placeholder }}" focus-from="focusTextInput" ng-model="chatbot.message.message" ng-keypress="chatbot.onInputKey($event)"><button type="submit" class="button icon" ng-click="chatbot.sendMessage()"><i class="fa fa-send-o"></i></button></div></div></div><div class="o-chatbot__buttons" ng-if="chatbot.pinned && !chatbot.isOpen"><button ng-click="chatbot.toggleChatbot()" class="button has-icon"><i class="fa fa-comments"></i>{{ chatbot.pinnedtext }}</button></div></div>')}]);
//# sourceMappingURL=akit.component.chatbot-widget.min.js.map
